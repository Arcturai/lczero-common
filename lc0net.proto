syntax = "proto2";

package lc0;

message Weights {
  required int32 version = 1;

  message ConvBlock {
    repeated float weights = 1 [packed=true];
    repeated float biases = 2 [packed=true];
    repeated float bn_means = 3 [packed=true];
    repeated float bn_stddivs = 4 [packed=true];
  }

  message Residual {
    required ConvBlock conv1 = 1;
    required ConvBlock conv2 = 2;
  }

  // Input convnet.
  required ConvBlock input = 2;

  // Residual tower.
  repeated Residual residual = 3;

  // Policy head
  required ConvBlock policy = 4;
  repeated float ip_pol_w = 5 [packed=true];
  repeated float ip_pol_b = 6 [packed=true];

  // Value head
  required ConvBlock value = 7;
  repeated float ip1_val_w = 8 [packed=true];
  repeated float ip1_val_b = 9 [packed=true];
  repeated float ip2_val_w = 10 [packed=true];
  repeated float ip2_val_b = 11 [packed=true];
}
