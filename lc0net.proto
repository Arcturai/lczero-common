syntax = "proto2";

package lc0;

message Weights {
  required int32 version = 1;

  message ConvBlock {
    optional bytes weights = 1;
    optional bytes biases = 2;
    optional bytes bn_means = 3;
    optional bytes bn_stddivs = 4;
  }

  message Residual {
    required ConvBlock conv1 = 1;
    required ConvBlock conv2 = 2;
  }

  // Input convnet.
  required ConvBlock input = 2;

  // Residual tower.
  repeated Residual residual = 3;

  // Policy head
  required ConvBlock policy = 4;
  optional bytes ip_pol_w = 5;
  optional bytes ip_pol_b = 6;

  // Value head
  required ConvBlock value = 7;
  optional bytes ip1_val_w = 8;
  optional bytes ip1_val_b = 9;
  optional bytes ip2_val_w = 10;
  optional bytes ip2_val_b = 11;

  // Training parameters
  optional uint32 training_steps = 12;
  optional uint32 server_id = 13;
  optional float learning_rate = 14;
  optional float mse_loss = 15;
  optional float policy_loss = 16;
  optional float accuracy = 17;
  optional float cpuct = 18;
}
